"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const ava_1 = require("ava");
const denali_1 = require("denali");
const lodash_1 = require("lodash");
ava_1.default.beforeEach((t) => {
    t.context.container = new denali_1.Container(__dirname);
});
// Ensure a given finder method invokes it's corresponding adapter method
function finderInvokesAdapter(t, finder, adapterReturn, ...args) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        t.plan(1);
        let container = t.context.container;
        container.register('service:db', denali_1.DatabaseService);
        container.register('model:post', class Post extends denali_1.Model {
        });
        container.register('orm-adapter:post', {
            buildRecord() { return {}; },
            [finder]() {
                t.pass();
                return adapterReturn;
            },
            getAttribute() { return null; }
        }, { instantiate: false, singleton: true });
        let db = container.lookup('service:db');
        yield db[finder]('post', ...args);
    });
}
finderInvokesAdapter.title = (providedTitle, finder) => `db.${finder} invokes the ${finder} method on the adapter`;
// Check the results of a finder method call, and stub out the corresponding adapter method
function finderReturns(t, options) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        t.plan(1);
        let container = t.context.container;
        container.register('service:db', denali_1.DatabaseService);
        container.register('model:post', class Post extends denali_1.Model {
        });
        container.register('orm-adapter:post', {
            buildRecord() { return {}; },
            [options.finder]: options.adapterMethod,
            getAttribute() { return null; }
        }, { instantiate: false, singleton: true });
        let db = container.lookup('service:db');
        let result = yield db[options.finder]('post', options.arg);
        options.assert(t, result);
    });
}
ava_1.default(finderInvokesAdapter, 'find', {}, 1);
ava_1.default(finderInvokesAdapter, 'queryOne', {}, { foo: true });
ava_1.default(finderInvokesAdapter, 'all', []);
ava_1.default(finderInvokesAdapter, 'query', [], { foo: true });
ava_1.default('find returns model instance', finderReturns, {
    finder: 'find',
    arg: 1,
    adapterMethod() { return {}; },
    assert(t, result) {
        t.true(result instanceof denali_1.Model);
    }
});
ava_1.default('find returns null if adapter does', finderReturns, {
    finder: 'find',
    arg: 1,
    adapterMethod() { return null; },
    assert(t, result) {
        t.is(result, null);
    }
});
ava_1.default('queryOne returns model instance', finderReturns, {
    finder: 'queryOne',
    arg: { foo: true },
    adapterMethod() { return {}; },
    assert(t, result) {
        t.true(result instanceof denali_1.Model);
    }
});
ava_1.default('queryOne returns null if adapter does', finderReturns, {
    finder: 'queryOne',
    arg: { foo: true },
    adapterMethod() { return null; },
    assert(t, result) {
        t.is(result, null);
    }
});
ava_1.default('all returns an array', finderReturns, {
    finder: 'all',
    arg: undefined,
    adapterMethod() { return []; },
    assert(t, result) {
        t.true(lodash_1.isArray(result));
    }
});
ava_1.default('query returns an array', finderReturns, {
    finder: 'query',
    arg: { foo: true },
    adapterMethod() { return []; },
    assert(t, result) {
        t.true(lodash_1.isArray(result));
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWJhc2UtdGVzdC5qcyIsInNvdXJjZVJvb3QiOiIvVXNlcnMvc2Vhd2F0dHMvc3JjL2dpdGh1Yi5jb20vc2Vhd2F0dHMvZGVuYWxpLyIsInNvdXJjZXMiOlsidGVzdC91bml0L2RhdGEvZGF0YWJhc2UtdGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSw2QkFBaUQ7QUFDakQsbUNBQTJEO0FBQzNELG1DQUFpQztBQUVqQyxhQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztJQUNoQixDQUFDLENBQUMsT0FBTyxDQUFDLFNBQVMsR0FBRyxJQUFJLGtCQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDakQsQ0FBQyxDQUFDLENBQUM7QUFFSCx5RUFBeUU7QUFDekUsOEJBQW9DLENBQTZCLEVBQUUsTUFBNkIsRUFBRSxhQUFrQixFQUFFLEdBQUcsSUFBVzs7UUFDbEksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNWLElBQUksU0FBUyxHQUFjLENBQUMsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDO1FBQy9DLFNBQVMsQ0FBQyxRQUFRLENBQUMsWUFBWSxFQUFFLHdCQUFlLENBQUMsQ0FBQztRQUNsRCxTQUFTLENBQUMsUUFBUSxDQUFDLFlBQVksRUFBRSxVQUFXLFNBQVEsY0FBSztTQUFHLENBQUMsQ0FBQztRQUM5RCxTQUFTLENBQUMsUUFBUSxDQUFDLGtCQUFrQixFQUFFO1lBQ3JDLFdBQVcsS0FBSyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUM1QixDQUFDLE1BQU0sQ0FBQztnQkFDTixDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7Z0JBQ1QsTUFBTSxDQUFDLGFBQWEsQ0FBQztZQUN2QixDQUFDO1lBQ0QsWUFBWSxLQUFVLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1NBQ3JDLEVBQUUsRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FB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dGVudCI6WyJpbXBvcnQgdGVzdCwgeyBUZXN0Q29udGV4dCwgQ29udGV4dCB9IGZyb20gJ2F2YSc7XG5pbXBvcnQgeyBNb2RlbCwgQ29udGFpbmVyLCBEYXRhYmFzZVNlcnZpY2UgfSBmcm9tICdkZW5hbGknO1xuaW1wb3J0IHsgaXNBcnJheSB9IGZyb20gJ2xvZGFzaCc7XG5cbnRlc3QuYmVmb3JlRWFjaCgodCkgPT4ge1xuICB0LmNvbnRleHQuY29udGFpbmVyID0gbmV3IENvbnRhaW5lcihfX2Rpcm5hbWUpO1xufSk7XG5cbi8vIEVuc3VyZSBhIGdpdmVuIGZpbmRlciBtZXRob2QgaW52b2tlcyBpdCdzIGNvcnJlc3BvbmRpbmcgYWRhcHRlciBtZXRob2RcbmFzeW5jIGZ1bmN0aW9uIGZpbmRlckludm9rZXNBZGFwdGVyKHQ6IFRlc3RDb250ZXh0ICYgQ29udGV4dDxhbnk+LCBmaW5kZXI6IGtleW9mIERhdGFiYXNlU2VydmljZSwgYWRhcHRlclJldHVybjogYW55LCAuLi5hcmdzOiBhbnlbXSkge1xuICB0LnBsYW4oMSk7XG4gIGxldCBjb250YWluZXI6IENvbnRhaW5lciA9IHQuY29udGV4dC5jb250YWluZXI7XG4gIGNvbnRhaW5lci5yZWdpc3Rlcignc2VydmljZTpkYicsIERhdGFiYXNlU2VydmljZSk7XG4gIGNvbnRhaW5lci5yZWdpc3RlcignbW9kZWw6cG9zdCcsIGNsYXNzIFBvc3QgZXh0ZW5kcyBNb2RlbCB7fSk7XG4gIGNvbnRhaW5lci5yZWdpc3Rlcignb3JtLWFkYXB0ZXI6cG9zdCcsIHtcbiAgICBidWlsZFJlY29yZCgpIHsgcmV0dXJuIHt9OyB9LFxuICAgIFtmaW5kZXJdKCkge1xuICAgICAgdC5wYXNzKCk7XG4gICAgICByZXR1cm4gYWRhcHRlclJldHVybjtcbiAgICB9LFxuICAgIGdldEF0dHJpYnV0ZSgpOiBhbnkgeyByZXR1cm4gbnVsbDsgfVxuICB9LCB7IGluc3RhbnRpYXRlOiBmYWxzZSwgc2luZ2xldG9uOiB0cnVlIH0pO1xuICBsZXQgZGIgPSBjb250YWluZXIubG9va3VwPERhdGFiYXNlU2VydmljZT4oJ3NlcnZpY2U6ZGInKTtcbiAgYXdhaXQgKDxhbnk+ZGJbZmluZGVyXSkoJ3Bvc3QnLCAuLi5hcmdzKTtcbn1cbig8YW55PmZpbmRlckludm9rZXNBZGFwdGVyKS50aXRsZSA9IChwcm92aWRlZFRpdGxlOiBzdHJpbmcsIGZpbmRlcjogc3RyaW5nKSA9PiBgZGIuJHsgZmluZGVyIH0gaW52b2tlcyB0aGUgJHsgZmluZGVyIH0gbWV0aG9kIG9uIHRoZSBhZGFwdGVyYDtcblxuLy8gQ2hlY2sgdGhlIHJlc3VsdHMgb2YgYSBmaW5kZXIgbWV0aG9kIGNhbGwsIGFuZCBzdHViIG91dCB0aGUgY29ycmVzcG9uZGluZyBhZGFwdGVyIG1ldGhvZFxuYXN5bmMgZnVuY3Rpb24gZmluZGVyUmV0dXJucyh0OiBUZXN0Q29udGV4dCAmIENvbnRleHQ8YW55Piwgb3B0aW9uczoge1xuICBmaW5kZXI6IGtleW9mIERhdGFiYXNlU2VydmljZSxcbiAgYXJnOiBhbnksXG4gIGFkYXB0ZXJNZXRob2QoKTogYW55LFxuICBhc3NlcnQodDogVGVzdENvbnRleHQsIHJlc3VsdDogYW55KTogdm9pZFxufSkge1xuICB0LnBsYW4oMSk7XG4gIGxldCBjb250YWluZXI6IENvbnRhaW5lciA9IHQuY29udGV4dC5jb250YWluZXI7XG4gIGNvbnRhaW5lci5yZWdpc3Rlcignc2VydmljZTpkYicsIERhdGFiYXNlU2VydmljZSk7XG4gIGNvbnRhaW5lci5yZWdpc3RlcignbW9kZWw6cG9zdCcsIGNsYXNzIFBvc3QgZXh0ZW5kcyBNb2RlbCB7fSk7XG4gIGNvbnRhaW5lci5yZWdpc3Rlcignb3JtLWFkYXB0ZXI6cG9zdCcsIHtcbiAgICBidWlsZFJlY29yZCgpIHsgcmV0dXJuIHt9OyB9LFxuICAgIFtvcHRpb25zLmZpbmRlcl06IG9wdGlvbnMuYWRhcHRlck1ldGhvZCxcbiAgICBnZXRBdHRyaWJ1dGUoKTogbnVsbCB7IHJldHVybiBudWxsOyB9XG4gIH0sIHsgaW5zdGFudGlhdGU6IGZhbHNlLCBzaW5nbGV0b246IHRydWUgfSk7XG4gIGxldCBkYiA9IGNvbnRhaW5lci5sb29rdXA8RGF0YWJhc2VTZXJ2aWNlPignc2VydmljZTpkYicpO1xuICBsZXQgcmVzdWx0ID0gYXdhaXQgKDxhbnk+ZGJbb3B0aW9ucy5maW5kZXJdKSgncG9zdCcsIG9wdGlvbnMuYXJnKTtcbiAgb3B0aW9ucy5hc3NlcnQodCwgcmVzdWx0KTtcbn1cblxudGVzdChmaW5kZXJJbnZva2VzQWRhcHRlciwgJ2ZpbmQnLCB7fSwgMSk7XG5cbnRlc3QoZmluZGVySW52b2tlc0FkYXB0ZXIsICdxdWVyeU9uZScsIHt9LCB7IGZvbzogdHJ1ZSB9KTtcblxudGVzdChmaW5kZXJJbnZva2VzQWRhcHRlciwgJ2FsbCcsIFtdKTtcblxudGVzdChmaW5kZXJJbnZva2VzQWRhcHRlciwgJ3F1ZXJ5JywgW10sIHsgZm9vOiB0cnVlIH0pO1xuXG50ZXN0KCdmaW5kIHJldHVybnMgbW9kZWwgaW5zdGFuY2UnLCBmaW5kZXJSZXR1cm5zLCB7XG4gIGZpbmRlcjogJ2ZpbmQnLFxuICBhcmc6IDEsXG4gIGFkYXB0ZXJNZXRob2QoKSB7IHJldHVybiB7fTsgfSxcbiAgYXNzZXJ0KHQ6IFRlc3RDb250ZXh0LCByZXN1bHQ6IGFueSkge1xuICAgIHQudHJ1ZShyZXN1bHQgaW5zdGFuY2VvZiBNb2RlbCk7XG4gIH1cbn0pO1xuXG50ZXN0KCdmaW5kIHJldHVybnMgbnVsbCBpZiBhZGFwdGVyIGRvZXMnLCBmaW5kZXJSZXR1cm5zLCB7XG4gIGZpbmRlcjogJ2ZpbmQnLFxuICBhcmc6IDEsXG4gIGFkYXB0ZXJNZXRob2QoKTogbnVsbCB7IHJldHVybiBudWxsOyB9LFxuICBhc3NlcnQodDogVGVzdENvbnRleHQsIHJlc3VsdDogYW55KSB7XG4gICAgdC5pcyhyZXN1bHQsIG51bGwpO1xuICB9XG59KTtcblxudGVzdCgncXVlcnlPbmUgcmV0dXJucyBtb2RlbCBpbnN0YW5jZScsIGZpbmRlclJldHVybnMsIHtcbiAgZmluZGVyOiAncXVlcnlPbmUnLFxuICBhcmc6IHsgZm9vOiB0cnVlIH0sXG4gIGFkYXB0ZXJNZXRob2QoKSB7IHJldHVybiB7fTsgfSxcbiAgYXNzZXJ0KHQ6IFRlc3RDb250ZXh0LCByZXN1bHQ6IGFueSkge1xuICAgIHQudHJ1ZShyZXN1bHQgaW5zdGFuY2VvZiBNb2RlbCk7XG4gIH1cbn0pO1xuXG50ZXN0KCdxdWVyeU9uZSByZXR1cm5zIG51bGwgaWYgYWRhcHRlciBkb2VzJywgZmluZGVyUmV0dXJucywge1xuICBmaW5kZXI6ICdxdWVyeU9uZScsXG4gIGFyZzogeyBmb286IHRydWUgfSxcbiAgYWRhcHRlck1ldGhvZCgpOiBudWxsIHsgcmV0dXJuIG51bGw7IH0sXG4gIGFzc2VydCh0OiBUZXN0Q29udGV4dCwgcmVzdWx0OiBhbnkpIHtcbiAgICB0LmlzKHJlc3VsdCwgbnVsbCk7XG4gIH1cbn0pO1xuXG50ZXN0KCdhbGwgcmV0dXJucyBhbiBhcnJheScsIGZpbmRlclJldHVybnMsIHtcbiAgZmluZGVyOiAnYWxsJyxcbiAgYXJnOiB1bmRlZmluZWQsXG4gIGFkYXB0ZXJNZXRob2QoKTogYW55W10geyByZXR1cm4gW107IH0sXG4gIGFzc2VydCh0OiBUZXN0Q29udGV4dCwgcmVzdWx0OiBhbnkpIHtcbiAgICB0LnRydWUoaXNBcnJheShyZXN1bHQpKTtcbiAgfVxufSk7XG5cbnRlc3QoJ3F1ZXJ5IHJldHVybnMgYW4gYXJyYXknLCBmaW5kZXJSZXR1cm5zLCB7XG4gIGZpbmRlcjogJ3F1ZXJ5JyxcbiAgYXJnOiB7IGZvbzogdHJ1ZSB9LFxuICBhZGFwdGVyTWV0aG9kKCk6IGFueVtdIHsgcmV0dXJuIFtdOyB9LFxuICBhc3NlcnQodDogVGVzdENvbnRleHQsIHJlc3VsdDogYW55KSB7XG4gICAgdC50cnVlKGlzQXJyYXkocmVzdWx0KSk7XG4gIH1cbn0pO1xuIl19